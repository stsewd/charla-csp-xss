<!DOCTYPE html>
<html data-theme="light">

<head>
  <!-- vim: set ft=html: -->
  <!-- Force Neovim to use HTML as filetype instead of angular -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="color-scheme" content="light">

  <!-- PicoCSS -->
  <link rel="stylesheet" href="../node_modules/@picocss/pico/css/pico.blue.min.css">
  <link rel="stylesheet" href="../node_modules/@picocss/pico/css/pico.colors.min.css">

  <!-- Fontawewome -->
  <link href="../node_modules/@fortawesome/fontawesome-free/css/all.min.css" rel="stylesheet">

  <!-- Highlight.js -->
  <script src="../node_modules/@highlightjs/cdn-assets/highlight.min.js" nonce="8IBTHwOdqNKAWeKl7plt8g==" >
  </script>
  <link rel="stylesheet" href="../node_modules/@highlightjs/cdn-assets/styles/dark.min.css">

  
  <meta id="csp" http-equiv="Content-Security-Policy" content="script-src &#39;nonce-8IBTHwOdqNKAWeKl7plt8g==&#39; &#39;sha256-opnq3UrQLt34nD/Io3x4OQXex7rVCcRNO2/Dym9R8ro=&#39;;">
  

  <script src="js/darkmode.js" nonce="8IBTHwOdqNKAWeKl7plt8g=="  defer></script>
  <title>
    
11 - CSP usando un nonce y hash

  </title>

  
<meta id="csp" http-equiv="Content-Security-Policy" content="script-src &#39;nonce-8IBTHwOdqNKAWeKl7plt8g==&#39; &#39;sha256-opnq3UrQLt34nD/Io3x4OQXex7rVCcRNO2/Dym9R8ro=&#39;;">
<script src="js/csp.js" nonce="8IBTHwOdqNKAWeKl7plt8g=="  defer></script>
<script src="js/showpayload.js" nonce="8IBTHwOdqNKAWeKl7plt8g=="  defer></script>

</head>

<body>
  <main class="container">
    <header>
      

      <nav>
        <ul>
          <h1>
            
11 - CSP usando un nonce y hash

          </h1>
        </ul>
        <ul>
          <li><a href=".">Índice</a></li>
          <li><a href="..">Slides</a></li>
        </ul>
      </nav>
      

<p class="pico-background-jade-500">Ejemplo no vulnerable</p>


    </header>

    <fieldset>
      <label>
        <input id="dark-mode-toggle" type="checkbox" role="switch" />
        Dark mode
      </label>
    </fieldset>

    
<section>
  <h2>
    <i class="fa-solid fa-shield-halved"></i>
    Content-Security-Policy
  </h2>
  <pre><code id="csp-content" class="language-http"></code></pre>
</section>

<section>
  <h2>
    <i class="fa-solid fa-code"></i>
    Payload
  </h2>
  <pre><code id="payload-content" class="language-html"></code></pre>
  <button id="inject">Inject</button>
  <a href="hash-and-nonce.html" role="button" class="secondary outline">Restart</a>
</section>

<section>
  <h2>
    <i class="fa-solid fa-syringe"></i>
    Injected content
  </h2>
  <div id="injection"></div>
</section>

<section>
  <h2>
    <i class="fa-solid fa-circle-exclamation"></i>
    Errors
  </h2>
  <pre><code id="errors"></code></pre>
</section>

<template id="payload-template"><script nonce="8IBTHwOdqNKAWeKl7plt8g==">
  alert("Este script si está permitido")
</script>

<script>alert("Inline script correspondiente al hash!")</script></template>



    
  <nav>
    <ul>
      <li>
        <a href="angularjs-is-back.html" role="button" class="secondary outline" >
          <i class="fa-solid fa-chevron-left"></i>
          anterior
        </a>
      </li>
    </ul>
    <ul>
      <li>
        <a href="." role="button" class="secondary outline">índice</a>
      </li>
    </ul>
    <ul>
      <li>
        <a href="hash-and-nonce-in-action.html" role="button" class="secondary outline" >
          siguiente
          <i class="fa-solid fa-chevron-right"></i>
        </a>
      </li>
    </ul>
  </nav>
  
  </main>
</body>

</html>